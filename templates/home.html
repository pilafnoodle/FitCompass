<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FitCompass - Home</title>

  <style>
    :root{
      --bg-main:#1f4d69;
      --bg-sidebar:#d8eff4;
      --btn-green:#a9d99b;
      --btn-red:#d83a4a;
      --card:#d8eff4;
      --text-dark:#0f1a1f;
      --shadow:0 10px 30px rgba(0,0,0,.18);
      --radius:14px;
      --font:ui-monospace, Menlo, Consolas, monospace;
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family:var(--font);
      background:#0f2330;
      color:white;
      min-height:100vh;
    }

    .app{ display:flex; min-height:100vh; }

    /* Sidebar */
    .sidebar{
      width:260px;
      background:var(--bg-sidebar);
      color:var(--text-dark);
      display:flex;
      flex-direction:column;
      padding:18px 14px;
      border-right:3px solid rgba(0,0,0,.08);
    }

    .sidebar-title{
      font-size:20px;
      margin-bottom:10px;
    }

    .nav{
      display:flex;
      flex-direction:column;
      gap:10px;
      flex:1;
    }

    .nav button{
      border:none;
      border-radius:10px;
      padding:12px;
      background:white;
      font-family:var(--font);
      cursor:pointer;
      text-align:left;
      box-shadow:0 4px 10px rgba(0,0,0,.08);
    }

    .logout button{
      border:none;
      border-radius:10px;
      padding:14px;
      background:var(--btn-red);
      font-family:var(--font);
      cursor:pointer;
    }

    /* Main */
    .main{
      flex:1;
      background:var(--bg-main);
      padding:22px;
    }

    .banner{
      background:rgba(255,255,255,.12);
      padding:14px;
      border-radius:12px;
      margin-bottom:20px;
    }

    .top-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:30px;
    }

    .progress{
      background:white;
      border-radius:10px;
      height:30px;
      width:360px;
      overflow:hidden;
    }

    .progress-fill{
      height:100%;
      background:var(--btn-green);
      color:black;
      font-weight:bold;
      display:flex;
      align-items:center;
      padding-left:10px;
    }

    .points{
      background:var(--btn-green);
      padding:10px 16px;
      border-radius:10px;
      font-size:18px;
      color:black;
    }

    .center{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:20px;
    }

    .logo-box{
      width:180px;
      height:180px;
      background:rgba(0,0,0,.18);
      border-radius:12px;
      display:grid;
      place-items:center;
    }

    /* Day buttons */
    .day-buttons{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:center;
    }

    .day-buttons button{
      background:white;
      border:none;
      border-radius:8px;
      padding:10px 14px;
      font-family:var(--font);
      cursor:pointer;
      box-shadow:0 4px 10px rgba(0,0,0,.1);
    }

    .day-buttons button.active{
      background:var(--btn-green);
      font-weight:bold;
    }

    /* Workout card */
    .card{
      background:var(--card);
      width:70%;
      min-height:240px;
      border-radius:12px;
      padding:16px;
      color:black;
      box-shadow:var(--shadow);
      overflow-y:auto;
      white-space:pre-wrap;
    }

    .start-btn{
      background:var(--btn-green);
      border:none;
      border-radius:10px;
      padding:14px 32px;
      font-size:22px;
      cursor:pointer;
    }
  </style>
</head>

<body>
<div class="app">

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <div class="sidebar-title">FitCompass</div>

    <div class="nav">
      <button onclick="location.href='{{ url_for('profile') }}'">Profile</button>
      <button onclick="location.href='{{ url_for('history') }}'">History</button>
      <button onclick="location.href='{{ url_for('library') }}'">Library</button>
      <button onclick="location.href='{{ url_for('shop') }}'">Shop</button>
      <button onclick="location.href='{{ url_for('settings') }}'">Settings</button>
    </div>

    <div class="logout">
      <button onclick="location.href='{{ url_for('logout') }}'">Log Out</button>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main">

    <div class="banner">
      <strong>Welcome, {{ username }}!</strong> Let’s get moving.
    </div>

    <div class="top-row">
      <div class="progress">
        <div class="progress-fill" style="width: {{ goal_percent }}%;">
          {{ goal_percent }}%
        </div>
      </div>

      <div class="points">
        Points: {{ points }}
      </div>
    </div>

    <section class="center">

      <!-- LOGO -->
      <div class="logo-box">
        <img src="{{ url_for('static', filename='logo.png') }}"
             style="max-width:100%; max-height:50%;" />
      </div>

      <!-- DAY BUTTONS -->
      <div class="day-buttons">
        {% set days = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"] %}
        {% for i in range(1,8) %}
          <button onclick="showWorkout({{ i }})">{{ days[i-1] }}</button>
        {% endfor %}
      </div>

      <!-- WORKOUT CARD -->
      <div class="card">
        <strong id="day-title">Select a Day</strong>
        <hr>
        <div id="workout-content">
          Click a day to view your workout.
        </div>
      </div>

      <!-- START BUTTON -->
      <button
        onclick="location.href='{{ url_for('workoutSession') }}'"
        class="start-btn"
        id="startBtn">
        START
      </button>

    </section>
  </main>
</div>

<script>
  const weeklyWorkouts = {{ weekly_workouts | tojson }};

  const dayNames = {
    1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",
    5:"Friday",6:"Saturday",7:"Sunday"
  };

  function showWorkout(day){
    const title = document.getElementById("day-title");
    const content = document.getElementById("workout-content");
    const startBtn = document.getElementById("startBtn");

    document.querySelectorAll(".day-buttons button")
      .forEach(b => b.classList.remove("active"));
    event.target.classList.add("active");

    title.textContent = `${dayNames[day]} Workout`;

    const exercises = weeklyWorkouts[`day_${day}`];

    if(exercises && exercises.length > 0){
      content.innerHTML = exercises.map(e => `• ${e}`).join("<br>");
      startBtn.disabled = false;
      startBtn.style.opacity = "1";
    } else {
      content.innerHTML = "Rest Day <br>Recovery, stretching, or light walking recommended.";
      startBtn.disabled = true;
      startBtn.style.opacity = ".5";
    }
  }
</script>

</body>
</html>
